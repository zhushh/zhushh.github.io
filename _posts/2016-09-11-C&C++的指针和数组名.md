---
layout: post
title: "C/C++的指针和数组名"
description: "理解C/C++数组名与指针的区别"
og_image: "documentation/sample-image.jpg"
tags: [C++, 指针, pointer, 数组名]
---


### 数组+1时移动距离
```c++
#include <stdio.h>

int main(int argc, char const *argv[])
{
    int a[4] = {1, 2, 3, 4};
    int *ptr = (int*)(&a+1);
    printf("%d\n", *(ptr-1));
    return 0;
}
```

输出结果：4

原因：
```
取标识符a它的地址加1会移动它本身元素个数的长度，
也就是说&a + 1 会向后移动四个位置,如下：
[1][2][3][4][null]
 |            |
 a           &a+1
```

### 指针移动
```c++
#include <iostream>
#include <cstdio>
using namespace std;

int main(int argc, char const *argv[])
{
    char *p[] = {"A", "B", "C"};
    char **pp[] = {p+2, p+1, p};
    char ***ppp = pp;
    printf("%s\n", **++ppp);
    printf("%s\n", *++*++ppp);
    return 0;
}

输出结果：
B
B

原因：
'++'和取值'*'运算的优先级是一样的，所以靠近的先执行；
'**++ppp'的执行顺序是先把ppp向后移动一位，在两次取值，所以输出"B";
'*++*++ppp'的执行顺序是先把ppp向后移动一位，再取值，得到的值是p，
然后对p进行'++'操作得到的是p+1的地址也就是指向字符串"B"

图示如下：
(1):                          (2)++ppp执行之后:     
["A"]["B"]["C"]               ["A"]["B"]["C"]      
  |    |    |                   |    |    |        
 [p0] [p1] [p2]                [p0] [p1] [p2]      
  |                             |                  
  p                             p                  
    [p2][p1][p0]                  [p2][p1][p0]     
     | \                          |     \          
     pp ppp                       pp    ppp        

(3)继续执行++ppp:              (4)最后++ppp执行之后:  
["A"]["B"]["C"]               ["A"]["B"]["C"]      
  |    |    |                   |    |    |        
 [p0] [p1] [p2]                [p0] [p1] [p2]      
  |                             |                  
  p                             p                  
    [p2][p1][p0]                  [p2][p1][p0]     
     |        \                    |        \      
     pp       ppp                  pp       ppp    

```
